Updated with the latest codes
